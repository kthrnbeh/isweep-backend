<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISweep Test - HTML5 Video</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        header {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        header h1 {
            color: #667eea;
            margin-bottom: 8px;
        }
        header p {
            color: #666;
            font-size: 14px;
        }
        .test-section {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .test-section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 20px;
        }
        .instructions {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }
        .instructions ol {
            margin-left: 20px;
        }
        .instructions li {
            margin-bottom: 8px;
            line-height: 1.6;
        }
        video {
            width: 100%;
            max-width: 800px;
            border: 3px solid #667eea;
            border-radius: 8px;
            margin-bottom: 20px;
            background: black;
        }
        .status-box {
            background: #f9f9f9;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 13px;
        }
        .status-box strong {
            color: #667eea;
        }
        code {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .warning {
            background: #fffbea;
            border-left: 4px solid #f39c12;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .success {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .info {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        footer {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            color: #666;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>üé¨ ISweep Test Suite</h1>
            <p>Testing HTML5 Video Filtering with Captions</p>
        </header>

        <!-- HTML5 Video Test -->
        <div class="test-section">
            <h2>Test 1: HTML5 Video Filtering</h2>
            
            <div class="instructions">
                <strong>Setup Instructions:</strong>
                <ol>
                    <li>Click ISweep icon in top-right ‚Üí <strong>‚öôÔ∏è Preferences</strong></li>
                    <li>Under <strong>Language</strong> category, add blocked word: <code>profanity</code></li>
                    <li>Click <strong>Save Settings</strong></li>
                    <li>Return to this page and click ISweep icon ‚Üí <strong>Enable ISweep</strong></li>
                    <li>Play the video below</li>
                    <li>When "profanity" appears in captions ‚Üí video should <strong>MUTE</strong></li>
                </ol>
            </div>

            <strong>Video with Captions:</strong>
            <video id="testVideo" controls crossorigin="anonymous">
                <track kind="captions" src="captions.vtt" srclang="en" label="English" default>
                <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
                Your browser does not support HTML5 video.
            </video>

            <div class="status-box">
                <strong>Expected Behavior:</strong>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>‚úì Green badge "‚úì ISweep Active" appears on video</li>
                    <li>‚úì Console shows: <code>[ISweep] Detected 1 video(s)</code></li>
                    <li>‚úì Video plays with captions visible</li>
                    <li>‚úì At ~3-6 seconds: Caption "This contains profanity word" appears</li>
                    <li>‚úì Large "MUTED" text appears in center of video</li>
                    <li>‚úì Video audio mutes</li>
                    <li>‚úì Popup shows "Actions Applied: 1"</li>
                </ul>
            </div>

            <div class="info">
                <strong>üîç Debug Tip:</strong> Open DevTools (F12) ‚Üí Console tab, filter for <code>[ISweep]</code> logs. 
                You should see caption extraction and action logs.
            </div>
        </div>

        <!-- Captions File Info -->
        <div class="test-section">
            <h2>Captions File (captions.vtt)</h2>
            
            <div class="warning">
                <strong>‚ö†Ô∏è Important:</strong> Place <code>captions.vtt</code> in the SAME folder as this HTML file so the <code>track</code> loads (e.g., keep both in <code>C:\ISweep_wireframe\tests\</code> and open the HTML from there).
            </div>

            <strong>Create this file with the following content:</strong>
            <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;"><code>WEBVTT

00:00:00.000 --> 00:00:03.000
This is a test video.

00:00:03.000 --> 00:00:06.000
The next word will trigger ISweep: profanity

00:00:06.000 --> 00:00:09.000
Back to normal content.

00:00:09.000 --> 00:00:12.000
This is more normal content.

00:00:12.000 --> 00:00:15.000
Here comes another trigger: profanity again

00:00:15.000 --> 00:00:18.000
End of test video.</code></pre>

            <div class="success">
                <strong>‚úÖ File location:</strong> Put <code>captions.vtt</code> right next to this HTML (example: <code>C:\ISweep_wireframe\tests\captions.vtt</code> if you move the HTML there).
            </div>

            <div class="info">
                <strong>üíª Serve locally to avoid file:// issues:</strong>
                <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">cd C:\ISweep_wireframe\tests
python -m http.server 8080
<-- then open -->
http://127.0.0.1:8080/isweep_test.html
</pre>
                If you must open with <code>file://</code>, enable "Allow access to file URLs" in Chrome extension settings for ISweep.
            </div>

            <div class="info">
                <strong>üìù Captions not showing?</strong> The <code>default</code> flag helps, but you may still need to toggle captions (CC) in the player UI.
            </div>
        </div>

        <!-- YouTube Testing -->
        <div class="test-section">
            <h2>Test 2: YouTube Filtering</h2>
            
            <div class="instructions">
                <strong>YouTube Setup Instructions:</strong>
                <ol>
                    <li>Go to <strong>YouTube.com</strong></li>
                    <li>Search for any music video (e.g., "Despacito", "Bohemian Rhapsody")</li>
                    <li>Click on video to play</li>
                    <li>Enable captions by clicking <strong>CC</strong> button (bottom right of video)</li>
                    <li>In ISweep popup, add blocked word: <code>music</code> (or <code>song</code>, <code>beat</code>)</li>
                    <li>Click <strong>Enable ISweep</strong></li>
                    <li>Play the video and watch for filtering</li>
                </ol>
            </div>

            <div class="status-box">
                <strong>Expected Behavior:</strong>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>‚úì Console shows: <code>[ISweep-YT] Initializing YouTube handler</code></li>
                    <li>‚úì Green badge appears on YouTube video</li>
                    <li>‚úì As captions appear with blocked words ‚Üí <strong>MUTED</strong></li>
                    <li>‚úì Large "MUTED" text appears in center</li>
                    <li>‚úì Console shows: <code>[ISweep-YT] Caption: "..."</code></li>
                    <li>‚úì Console shows: <code>[ISweep-YT] Action: mute</code></li>
                    <li>‚úì Stats update: "Actions Applied" increments</li>
                </ul>
            </div>

            <div class="info">
                <strong>üí° Best Videos to Test:</strong>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>Music videos (lots of repeated words)</li>
                    <li>TED Talks (full captions, educational)</li>
                    <li>News clips (BBC, CNN - high caption quality)</li>
                    <li>Any video with auto-generated captions enabled</li>
                </ul>
            </div>

            <div class="warning">
                <strong>‚ö†Ô∏è Note:</strong> YouTube may take 1-2 seconds to show captions after play. 
                If you don't see filtering, check that captions are actually visible on the video.
            </div>
        </div>

        <!-- Debugging -->
        <div class="test-section">
            <h2>üêõ Debugging Checklist</h2>
            
            <div class="status-box">
                <strong>If filtering is NOT working:</strong>
                <ol style="margin-left: 20px; margin-top: 10px;">
                    <li>‚úì Backend running? Test: <code>http://127.0.0.1:8001/health</code></li>
                    <li>‚úì ISweep enabled? Click icon and check "Active" status</li>
                    <li>‚úì Captions enabled? Right-click video ‚Üí "Show transcript" or CC button</li>
                    <li>‚úì Blocked word matches caption? (case-insensitive)</li>
                    <li>‚úì DevTools console open? F12 ‚Üí Console tab ‚Üí Filter: <code>[ISweep]</code></li>
                </ol>
            </div>

            <div class="info">
                <strong>Console Log Examples You Should See:</strong>
                <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; font-size: 12px; overflow-x: auto;"><code>[ISweep] Content script loaded
[ISweep] Detected 1 video(s)
[ISweep] Loaded 6 caption cues
[ISweep] Video 0 started playing
[ISweep] Caption: "This contains profanity word"
[ISweep] Action: mute - Blocked word match: 'profanity'</code></pre>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <p>ISweep Test Suite v0.1 | Backend: http://127.0.0.1:8001</p>
        </footer>
    </div>
</body>
</html>